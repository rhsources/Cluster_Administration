<?xml version='1.0'?>
<!DOCTYPE appendix PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % RH_ENTITIES SYSTEM "./Common_Config/rh-entities.ent">
%RH_ENTITIES;
]>

<appendix id="ap-hwinfo"><title>Supplementary Hardware Information</title>
<indexterm>
	
	<primary>hardware information, supplementary</primary>
</indexterm>
<para>
	 The following sections provide additional information about configuring the hardware used in a cluster system. 
</para>
<section id="s1-hwinfo-storage-reqs">
	<title>Attached Storage Requirements</title>
	<para>
		 The following sections detail the steps to consider when directly connecting storage devices to cluster nodes, whether using SCSI host-bus adapters or Fibre Channel connections. 
	</para>
</section>
<section id="s1-hwinfo-singlefibre">
	<title>Setting Up a Fibre Channel Interconnect</title>
	<indexterm>
		
		<primary>single-initiator fibre channel interconnect</primary>
		<secondary>setting up</secondary>
	</indexterm>
	<para>
		 Fibre Channel can be used in either single-initiator or multi-initiator configurations. 
	</para>
	<para>
		 A single-initiator Fibre Channel interconnect has only one node connected to it. This may provide better host isolation and better performance than a multi-initiator bus. Single-initiator interconnects ensure that each node is protected from disruptions due to the workload, initialization, or repair of the other node. 
	</para>
	<para>
		 If employing a RAID array that has multiple host ports, and the RAID array provides simultaneous access to all the shared logical units from the host ports on the storage enclosure, set up single-initiator Fibre Channel interconnects to connect each node to the RAID array. If a logical unit can fail over from one controller to the other, the process must be transparent to the operating system. 
	</para>
	<para>
		<xref linkend="fig-hardware-scrsif" /> shows a single-controller RAID array with two host ports and the host bus adapters connected directly to the RAID controller, without using Fibre Channel hubs or switches. When using this type of single-initiator Fibre Channel connection, your RAID controller must have a separate host port for each cluster node. 
	</para>
	<figure id="fig-hardware-scrsif">
		<title>Single-controller RAID Array Connected to Single-initiator Fibre Channel Interconnects</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/single_fibre.png" />
			</imageobject>
			<textobject><para>
				 Single-Controller RAID Array Connected to Single-Initiator Fibre Channel Interconnects 
			</para>
			</textobject>
		</mediaobject>
	</figure>
	<para>
		 The external RAID array must have a separate SCSI channel for each cluster node. In clusters with more than two nodes, connect each node to the SCSI channel on the RAID array, using a single-initiator SCSI bus as shown in <xref linkend="fig-hardware-scrsif" />. 
	</para>
	<para>
		 To connect multiple cluster nodes to the same host port on the RAID array, use a Fibre Channel hub or switch. In this case, each host bus adapter is connected to the hub or switch, and the hub or switch is connected to a host port on the RAID controller. 
	</para>
	<para>
		 A Fibre Channel hub or switch is also required with a dual-controller RAID array with two host ports on each controller. This configuration is shown in <xref linkend="fig-hardware-dcrsif" />. Additional cluster nodes may be connected to either Fibre Channel hub or switch shown in the diagram. Some RAID arrays include a built-in hub so that each host port is already connected to each of the internal RAID controllers. In this case, an additional external hub or switch may not be needed. 
	</para>
	<figure id="fig-hardware-dcrsif">
		<title>Dual-controller RAID Array Connected to Single-initiator Fibre Channel Interconnects</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/fibre_hub.png" />
			</imageobject>
			<textobject><para>
				 Single-Controller RAID Array Connected to Single-Initiator Fibre Channel Interconnects 
			</para>
			</textobject>
		</mediaobject>
	</figure>
</section>
<section id="s1-hwinfo-singlesetup">
	<title>SCSI Storage Requirements</title>
	<indexterm>
		
		<primary>SCSI storage</primary>
		<secondary>requirements</secondary>
	</indexterm>
	<para>
		 A single-initiator SCSI bus has only one node connected to it, and provides host isolation and better performance than a multi-initiator bus. Single-initiator buses ensure that each node is protected from disruptions due to the workload, initialization, or repair of the other nodes. 
	</para>
	<para>
		 When using a single- or dual-controller RAID array that has multiple host ports and provides simultaneous access to all the shared logical units from the host ports on the storage enclosure, the setup of the single-initiator SCSI buses to connect each cluster node to the RAID array is possible. If a logical unit can fail over from one controller to the other, the process must be transparent to the operating system. Note that some RAID controllers restrict a set of disks to a specific controller or port. In this case, single-initiator bus setups are not possible. 
	</para>
	<para>
		 A single-initiator bus must adhere to the requirements described in <xref linkend="s2-hwinfo-scsibusconf" />. 
	</para>
	<para>
		 To set up a single-initiator SCSI bus configuration, perform the following steps: 
	</para>
	<itemizedlist>
		<listitem>
			<para>
				 Enable the onboard termination for each host bus adapter. 
			</para>
		</listitem>
		<listitem>
			<para>
				 Enable the termination for each RAID controller. 
			</para>
		</listitem>
		<listitem>
			<para>
				 Use the appropriate SCSI cable to connect each host bus adapter to the storage enclosure. 
			</para>
		</listitem>
	</itemizedlist>
	<para>
		 Setting host bus adapter termination is done in the adapter BIOS utility during system boot. To set RAID controller termination, refer to the vendor documentation. <xref linkend="fig-hardware-multi3" /> shows a configuration that uses two single-initiator SCSI buses. 
	</para>
	<figure id="fig-hardware-multi3">
		<title>Single-initiator SCSI Bus Configuration</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/multidrop_3.png" />
			</imageobject>
			<textobject><para>
				 Example configuration that uses two single-initiator SCSI buses. 
			</para>
			</textobject>
		</mediaobject>
	</figure>
	<para>
		<xref linkend="fig-hardware-srs" /> shows the termination in a single-controller RAID array connected to two single-initiator SCSI buses. 
	</para>
	<figure id="fig-hardware-srs">
		<title>Single-controller RAID Array Connected to Single-initiator SCSI Buses</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/single_raid_store.png" />
			</imageobject>
			<textobject><para>
				 Example termination in a single-controller RAID array connected to two single-initiator SCSI buses. 
			</para>
			</textobject>
		</mediaobject>
	</figure>
	<para>
		<xref linkend="fig-hardware-drs" /> shows the termination in a dual-controller RAID array connected to two single-initiator SCSI buses. 
	</para>
	<figure id="fig-hardware-drs">
		<title>Dual-controller RAID Array Connected to Single-initiator SCSI Buses</title>
		<mediaobject>
			<imageobject>
				<imagedata fileref="images/dual_raid_store.png" />
			</imageobject>
			<textobject><para>
				 Example termination in a dual-controller RAID array connected to two single-initiator SCSI buses. 
			</para>
			</textobject>
		</mediaobject>
	</figure>
	<section id="s2-hwinfo-scsibusconf">
		<title>SCSI Configuration Requirements</title>
		<indexterm>
			
			<primary>SCSI configuration requirements</primary>
		</indexterm>
		<para>
			 SCSI devices must adhere to a number of configuration requirements to operate correctly. Failure to adhere to these requirements adversely affects cluster operation and resource availability. 
		</para>
		<para>
			 The following is an overview of SCSI configuration requirements: 
		</para>
		<itemizedlist>
			<listitem>
				<para>
					 Buses must be terminated at each end. Refer to <xref linkend="s2-hwinfo-scsibus" /> for more information. 
				</para>
			</listitem>
			<listitem>
				<para>
					 Buses must not extend beyond the maximum length restriction for the bus type. Internal cabling must be included in the length of the SCSI bus. Refer to <xref linkend="s2-hwinfo-length" /> for more information. 
				</para>
			</listitem>
			<listitem>
				<para>
					 All devices (host bus adapters and disks) on a bus must have unique SCSI identification numbers. Refer to <xref linkend="s2-hwinfo-num" /> for more information. 
				</para>
			</listitem>
			<listitem>
				<para>
					 The Linux device name for each shared SCSI device must be the same on each cluster system. For example, a device named <filename>/dev/sdc</filename> on one cluster system must be named <filename>/dev/sdc</filename> on the other cluster system. One way to ensure that devices are named the same is by using identical hardware for both cluster systems. 
				</para>
			</listitem>
		</itemizedlist>
		<para>
			 Use the system's configuration utility to set SCSI identification numbers and enable host bus adapter termination. When the system boots, a message is displayed describing how to start the utility. For example, the utility prompts the user to press <keycombo><keycap>Ctrl</keycap><keycap>A</keycap></keycombo>, and follow the prompts to perform a particular task. To set storage enclosure and RAID controller termination, refer to the vendor documentation. Refer to <xref linkend="s2-hwinfo-scsibus" /> and <xref linkend="s2-hwinfo-num" /> for more information. 
		</para>
	</section>
	<section id="s2-hwinfo-scsibus">
		<title>SCSI Bus Termination</title>
		<indexterm>
			
			<primary>SCSI bus termination</primary>
		</indexterm>
		<para>
			 A SCSI bus is an electrical path between two terminators. A device (host bus adapter, RAID controller, or disk) attaches to a SCSI bus by a short <firstterm>stub</firstterm>, which is an unterminated bus segment that usually must be less than 0.1 meter in length. 
		</para>
		<para>
			 Buses must have only two terminators located at opposing ends of the bus. Additional terminators, terminators that are not at the ends of the bus, or long stubs cause the bus to operate incorrectly. Termination for a SCSI bus can be provided by the devices connected to the bus or by external terminators, if the internal (onboard) device termination can be disabled. 
		</para>
		<para>
			 Testing has shown that external termination on HBAs that run at speeds greater than 80MB/second does not work reliably. 
		</para>
		<para>
			 When disconnecting a device from a single-initiator SCSI bus follow these guidelines: 
		</para>
		<itemizedlist>
			<listitem>
				<para>
					 Unterminated SCSI cables must not be connected to an operational host bus adapter or storage device. 
				</para>
			</listitem>
			<listitem>
				<para>
					 Connector pins must not bend or touch an electrical conductor while the SCSI cable is disconnected. 
				</para>
			</listitem>
			<listitem>
				<para>
					 To disconnect a host bus adapter from a single-initiator bus, first disconnect the SCSI cable from the RAID controller and then from the adapter. This ensures that the RAID controller is not exposed to any erroneous input. 
				</para>
			</listitem>
			<listitem>
				<para>
					 Protect connector pins from electrostatic discharge while the SCSI cable is disconnected by wearing a grounded anti-static wrist guard and physically protecting the cable ends from contact with other objects. 
				</para>
			</listitem>
			<listitem>
				<para>
					 Do not remove a device that is currently participating in any SCSI bus transactions. 
				</para>
			</listitem>
		</itemizedlist>
		<para>
			 To enable or disable an adapter's internal termination, use the system BIOS utility. When the system boots, a message is displayed describing how to start the utility. For example, many utilities prompt users to press <keycap>Ctrl</keycap>-<keycap>A</keycap>. Follow the prompts for setting the termination. At this point, it is also possible to set the SCSI identification number, as needed, and disable SCSI bus resets. Refer to <xref linkend="s2-hwinfo-num" /> for more information. 
		</para>
		<para>
			 To set storage enclosure and RAID controller termination, refer to the vendor documentation. 
		</para>
	</section>
	<section id="s2-hwinfo-length">
		<title>SCSI Bus Length</title>
		<indexterm>
			
			<primary>SCSI bus length</primary>
		</indexterm>
		<indexterm>
			
			<primary>low voltage differential (LVD)</primary>
		</indexterm>
		<para>
			 A SCSI bus must adhere to length restrictions for the bus type. Buses that do not adhere to these restrictions do not operate properly. The length of a SCSI bus is calculated from one terminated end to the other and must include any cabling that exists inside the system or storage enclosures. 
		</para>
		<para>
			 A cluster supports LVD (low voltage differential) buses. The maximum length of a single-initiator LVD bus is 25 meters. The maximum length of a multi-initiator LVD bus is 12 meters. According to the SCSI standard, a single-initiator LVD bus is a bus that is connected to only two devices, each within 0.1 meter from a terminator. All other buses are defined as multi-initiator buses. 
		</para>
		<para>
			 Do not connect any single-ended devices to an LVD bus; doing so converts the bus single-ended, which has a much shorter maximum length than a differential bus. 
		</para>
	</section>
	<section id="s2-hwinfo-num">
		<title>SCSI Identification Numbers</title>
		<indexterm>
			
			<primary>SCSI identification numbers</primary>
		</indexterm>
		<para>
			 Each device on a SCSI bus must have a unique SCSI identification number. Devices include host bus adapters, RAID controllers, and disks. 
		</para>
		<para>
			 The number of devices on a SCSI bus depends on the data path for the bus. A cluster supports wide SCSI buses, which have a 16-bit data path and support a maximum of 16 devices. Therefore, there are sixteen possible SCSI identification numbers that can be assigned to the devices on a bus. 
		</para>
		<para>
			 In addition, SCSI identification numbers are prioritized. Use the following priority order to assign SCSI identification numbers: 
		</para>
		<screen><computeroutput>7 - 6 - 5 - 4 - 3 - 2 - 1 - 0 - 15 - 14 - 13 - 12 - 11 - 10 - 9 - 8 </computeroutput></screen><para>
			 The previous order specifies that 7 is the highest priority, and 8 is the lowest priority. The default SCSI identification number for a host bus adapter is 7, because adapters are usually assigned the highest priority. It is possible to assign identification numbers for logical units in a RAID subsystem by using the RAID management interface. 
		</para>
		<para>
			 To modify an adapter's SCSI identification number, use the system BIOS utility. When the system boots, a message is displayed describing how to start the utility. For example, a user may be prompted to press <keycombo><keycap>Ctrl</keycap><keycap>A</keycap></keycombo> and follow the prompts for setting the SCSI identification number. At this point, it is possible to enable or disable the adapter's internal termination, as needed, and disable SCSI bus resets. Refer to <xref linkend="s2-hwinfo-scsibus" /> for more information. 
		</para>
		<para>
			 The prioritized arbitration scheme on a SCSI bus can result in low-priority devices being locked out for some period of time. This may cause commands to time out, if a low-priority storage device, such as a disk, is unable to win arbitration and complete a command that a host has queued to it. For some workloads, it is possible to avoid this problem by assigning low-priority SCSI identification numbers to the host bus adapters. 
		</para>
	</section>
</section>
</appendix>
