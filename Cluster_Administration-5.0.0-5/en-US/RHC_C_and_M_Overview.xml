<?xml version='1.0'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
<!ENTITY % RH_ENTITIES SYSTEM "./Common_Config/rh-entities.ent">
%RH_ENTITIES;
]>

<chapter id="ch-overview">
	<title>&RH; Cluster Configuration and Management Overview</title>
	<para>
		&RH; Cluster allows you to connect a group of computers (called <firstterm>nodes</firstterm> or <firstterm>members</firstterm>) to work together as a cluster. You can use &RH; Cluster to suit your clustering needs (for example, setting up a cluster for sharing files on a GFS file system or setting up service failover). more. 
	</para>
	<para>
		 To set up a cluster, you must connect the nodes to certain cluster hardware and configure the nodes into the cluster environment. This chapter provides an overview of the configuration process and tools available for configuring and managing a &RH; Cluster. 
	</para>
	<section id="s1-clumgmttools-overview">
		<title>Cluster Administration GUI</title>
		<para>
			 This section provides an overview of the cluster administration graphical user interface (GUI) available with &RHCS; &amp;mdash; <command>system-config-cluster</command>. The GUI is for use with the cluster infrastructure and the high-availability service management components. The GUI consists of two major functions: the <application>&RHCLUSTERTOOL;</application> and the <application>&RHCLUSTERSTATTOOL;</application>. The <application>&RHCLUSTERTOOL;</application> provides the capability to create, edit, and propagate the cluster configuration file (<filename>/etc/cluster/cluster.conf</filename>). The <application>&RHCLUSTERSTATTOOL;</application> provides the capability to manage high-availability services. The following sections summarize those functions. 
		</para>
		<section id="s2-cluconfig-tool">
			<title><application>&RHCLUSTERTOOL;</application></title>
			<para>
				 You can access the <application>&RHCLUSTERTOOL;</application>(<xref linkend="fig-intro-cluconfig-ov" />) through the <guilabel>Cluster Configuration</guilabel> tab in the Cluster Administration GUI. 
			</para>
			<figure id="fig-intro-cluconfig-ov">
				<title><application>&RHCLUSTERTOOL;</application></title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="./images/clustertoolgui.png" />
					</imageobject>
					<textobject><para>
						 cluster tool 
					</para>
					</textobject>
				</mediaobject>
			</figure>
			<para>
				 The <application>&RHCLUSTERTOOL;</application> represents cluster configuration components in the configuration file (<filename>/etc/cluster/cluster.conf</filename>) with a hierarchical graphical display in the left panel. A triangle icon to the left of a component name indicates that the component has one or more subordinate components assigned to it. Clicking the triangle icon expands and collapses the portion of the tree below a component. The components displayed in the GUI are summarized as follows: 
			</para>
			<itemizedlist>
				<listitem>
					<para>
						<guilabel>Cluster Nodes</guilabel>&amp;mdash; Displays cluster nodes. Nodes are represented by name as subordinate elements under <guilabel>Cluster Nodes</guilabel>. Using configuration buttons at the bottom of the right frame (below <guilabel>Properties</guilabel>), you can add nodes, delete nodes, edit node properties, and configure fencing methods for each node. 
					</para>
				</listitem>
				<listitem>
					<para>
						<guilabel>Fence Devices</guilabel>&amp;mdash; Displays fence devices. Fence devices are represented as subordinate elements under <guilabel>Fence Devices</guilabel>. Using configuration buttons at the bottom of the right frame (below <guilabel>Properties</guilabel>), you can add fence devices, delete fence devices, and edit fence-device properties. Fence devices must be defined before you can configure fencing (with the <guibutton>Manage Fencing For This Node</guibutton> button) for each node. 
					</para>
				</listitem>
				<listitem>
					<para>
						<guilabel>Managed Resources</guilabel>&amp;mdash; Displays failover domains, resources, and services. 
					</para>
					<itemizedlist>
						<listitem>
							<para>
								<guilabel>Failover Domains</guilabel>&amp;mdash; For configuring one or more subsets of cluster nodes used to run a high-availability service in the event of a node failure. Failover domains are represented as subordinate elements under <guilabel>Failover Domains</guilabel>. Using configuration buttons at the bottom of the right frame (below <guilabel>Properties</guilabel>), you can create failover domains (when <guilabel>Failover Domains</guilabel> is selected) or edit failover domain properties (when a failover domain is selected). 
							</para>
						</listitem>
						<listitem>
							<para>
								<guilabel>Resources</guilabel>&amp;mdash; For configuring shared resources to be used by high-availability services. Shared resources consist of file systems, IP addresses, NFS mounts and exports, and user-created scripts that are available to any high-availability service in the cluster. Resources are represented as subordinate elements under <guilabel>Resources</guilabel>. Using configuration buttons at the bottom of the right frame (below <guilabel>Properties</guilabel>), you can create resources (when <guilabel>Resources</guilabel> is selected) or edit resource properties (when a resource is selected). 
							</para>
							<note>
								<title>Note</title>
								<para>
									 The <application>&RHCLUSTERTOOL;</application> provides the capability to configure private resources, also. A private resource is a resource that is configured for use with only one service. You can configure a private resource within a <application>Service</application> component in the GUI. 
								</para>
							</note>
						</listitem>
						<listitem>
							<para>
								<guilabel>Services</guilabel>&amp;mdash; For creating and configuring high-availability services. A service is configured by assigning resources (shared or private), assigning a failover domain, and defining a recovery policy for the service. Services are represented as subordinate elements under <guilabel>Services</guilabel>. Using configuration buttons at the bottom of the right frame (below <guilabel>Properties</guilabel>), you can create services (when <guilabel>Services</guilabel> is selected) or edit service properties (when a service is selected). 
							</para>
						</listitem>
					</itemizedlist>
				</listitem>
			</itemizedlist>
			<indexterm>
				
				<primary><application>&RHCLUSTERTOOL;</application></primary>
				<secondary>accessing</secondary>
			</indexterm>
			<para>
				<xref linkend="fig-software-flow" /> shows an example of the hierarchical relationship among cluster nodes, high-availability services, and resources. The cluster nodes are connected to one or more fencing devices. Nodes can be grouped into a failover domain for a cluster service. The services comprise resources such as NFS exports, IP addresses, and shared GFS partitions. 
			</para>
			<figure id="fig-software-flow">
				<title>Cluster Configuration Structure</title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="./images/clust-config-struct.png" />
					</imageobject>
					<textobject><para>
						 cluster config flowchart 
					</para>
					</textobject>
				</mediaobject>
			</figure>
		</section>
		<section id="s2-admin-overview">
			<title><application>&RHCLUSTERSTATTOOL;</application></title>
			<para>
				 You can access the <application>&RHCLUSTERSTATTOOL;</application>(<xref linkend="fig-intro-clustatus" />) through the <guimenu>Cluster Management</guimenu> tab in Cluster Administration GUI. 
			</para>
			<figure id="fig-intro-clustatus">
				<title><application>&RHCLUSTERSTATTOOL;</application></title>
				<mediaobject>
					<imageobject>
						<imagedata fileref="./images/clustatus.png" />
					</imageobject>
					<textobject><para>
						 cluster status tool 
					</para>
					</textobject>
				</mediaobject>
			</figure>
			<para>
				 The nodes and services displayed in the <application>&RHCLUSTERSTATTOOL;</application> are determined by the cluster configuration file (<filename>/etc/cluster/cluster.conf</filename>). You can use the <application>&RHCLUSTERSTATTOOL;</application> to enable, disable, restart, or relocate a high-availability service. The <application>&RHCLUSTERSTATTOOL;</application> displays the current cluster status in the <guilabel>Services </guilabel> area and automatically updates the status every 10 seconds. 
			</para>
			<para>
				 To enable a service, you can select the service in the <guilabel>Services</guilabel> area and click <guilabel>Enable</guilabel>. To disable a service, you can select the service in the <guilabel>Services</guilabel> area and click <guilabel>Disable</guilabel>. To restart a service, you can select the service in the <guilabel>Services</guilabel> area and click <guilabel>Restart</guilabel>. To relocate a service from one node to another, you can drag the service to another node and drop the service onto that node. Relocating a node restarts the service on that node. (Relocating a service to its current node &amp;mdash; that is, dragging a service to its current node and dropping the service onto that node &amp;mdash; restarts the service.) 
			</para>
			<indexterm>
				
				<primary>cluster administration</primary>
				<secondary>displaying cluster and service status</secondary>
			</indexterm>
			<indexterm>
				
				<primary>cluster</primary>
				<secondary>displaying status</secondary>
			</indexterm>
			<indexterm>
				
				<primary>cluster service</primary>
				<secondary>displaying status</secondary>
			</indexterm>
			<para>
				 The following tables describe the members and services status information displayed by the <application>&RHCLUSTERSTATTOOL;</application>. 
			</para>
			<table id="tb-admin-memberstattool">
				<title>Members Status</title>
				<tgroup cols="2">
					<colspec colname="MemberStatus" colnum="1" colwidth="3*"></colspec><colspec colname="Description" colnum="2" colwidth="9*"></colspec><thead>
						<row>
							<entry>
								 Members Status
							</entry>
							<entry>
								 Description
							</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>
								<guilabel>Member</guilabel>
							</entry>
							<entry>
								<simplelist>
									<member>The node is part of the cluster.</member>
									<member>Note: A node can be a member of a cluster; however, the node may be inactive and incapable of running services. For example, if <command>rgmanager</command>is not running on the node, but all other cluster software components are running in the node, the node appears as a <guilabel>Member</guilabel>in the <application>&RHCLUSTERSTATTOOL;</application>. </member>
								</simplelist>
							</entry>
						</row>
						<row>
							<entry>
								<guilabel>Dead</guilabel>
							</entry>
							<entry>
								 The node is unable to participate as a cluster member. The most basic cluster software is not running on the node. 
							</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
			<table id="tb-admin-servicestat">
				<title>Services Status</title>
				<tgroup cols="2">
					<colspec colname="ServiceStatus" colnum="1" colwidth="3*"></colspec><colspec colname="Description" colnum="2" colwidth="9*"></colspec><thead>
						<row>
							<entry>
								 Services Status
							</entry>
							<entry>
								 Description
							</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>
								<guilabel>Started</guilabel>
							</entry>
							<entry>
								 The service resources are configured and available on the cluster system that owns the service.
							</entry>
						</row>
						<row>
							<entry>
								<guilabel>Pending</guilabel>
							</entry>
							<entry>
								 The service has failed on a member and is pending start on another member. 
							</entry>
						</row>
						<row>
							<entry>
								<guilabel>Disabled</guilabel>
							</entry>
							<entry>
								 The service has been disabled, and does not have an assigned owner. A disabled service is never restarted automatically by the cluster.
							</entry>
						</row>
						<row>
							<entry>
								<guilabel>Stopped</guilabel>
							</entry>
							<entry>
								 The service is not running; it is waiting for a member capable of starting the service. A service remains in the stopped state if autostart is disabled.
							</entry>
						</row>
						<row>
							<entry>
								<guilabel>Failed</guilabel>
							</entry>
							<entry>
								 The service has failed to start on the cluster and cannot successfully stop the service. A failed service is never restarted automatically by the cluster. 
							</entry>
						</row>
					</tbody>
				</tgroup>
			</table>
		</section>
	</section>
	<section id="s1-cmdlinetools-overview">
		<title>Command Line Administration Tools</title>
		<para>
			 In addition to the Cluster Administration GUI, command line tools are available for administering the cluster infrastructure and the high-availability service management components. The command line tools are used by the Cluster Administration GUI and init scripts supplied by &RH;. <xref linkend="tb-commandline-tools" /> summarizes the command line tools. 
		</para>
		<table id="tb-commandline-tools">
			<title>Command Line Tools</title>
			<tgroup cols="3">
				<colspec colname="Command_Line_Tool" colnum="1" colwidth="3*"></colspec><colspec colname="Used_With" colnum="2" colwidth="3*"></colspec><colspec colname="Purpose" colnum="3" colwidth="9*"></colspec><thead>
					<row>
						<entry>
							 Command Line Tool
						</entry>
						<entry>
							 Used With
						</entry>
						<entry>
							 Purpose
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<command>ccs_tool</command>							&amp;mdash; Cluster Configuration System Tool
						</entry>
						<entry>
							 Cluster Infrastructure
						</entry>
						<entry>
							<command>ccs_tool</command>							is a program for making online updates to the cluster configuration file. It provides the capability to create and modify cluster infrastructure components (for example, creating a cluster, adding and removing a node). For more information about this tool, refer to the ccs_tool(8) man page.
						</entry>
					</row>
					<row>
						<entry>
							<command>cman_tool</command>							&amp;mdash; Cluster Management Tool
						</entry>
						<entry>
							 Cluster Infrastructure
						</entry>
						<entry>
							<command>cman_tool</command>							is a program that manages the CMAN cluster manager. It provides the capability to join a cluster, leave a cluster, kill a node, or change the expected quorum votes of a node in a cluster. For more information about this tool, refer to the cman_tool(8) man page.
						</entry>
					</row>
					<row>
						<entry>
							<command>fence_tool</command>							&amp;mdash; Fence Tool
						</entry>
						<entry>
							 Cluster Infrastructure
						</entry>
						<entry>
							<command>fence_tool</command>							is a program used to join or leave the default fence domain. Specifically, it starts the fence daemon (<command>fenced</command>) to join the domain and kills <command>fenced</command> to leave the domain. For more information about this tool, refer to the fence_tool(8) man page.
						</entry>
					</row>
					<row>
						<entry>
							<command>clustat</command>							&amp;mdash; Cluster Status Utility
						</entry>
						<entry>
							 High-availability Service Management Components
						</entry>
						<entry>
							 The <command>clustat</command> command displays the status of the cluster. It shows membership information, quorum view, and the state of all configured user services. For more information about this tool, refer to the clustat(8) man page.
						</entry>
					</row>
					<row>
						<entry>
							<command>clusvcadm</command>							&amp;mdash; Cluster User Service Administration Utility
						</entry>
						<entry>
							 High-availability Service Management Components
						</entry>
						<entry>
							 The <command>clusvcadm</command> command allows you to enable, disable, relocate, and restart high-availability services in a cluster. For more information about this tool, refer to the clusvcadm(8) man page.
						</entry>
					</row>
				</tbody>
			</tgroup>
		</table>
	</section>
</chapter>

