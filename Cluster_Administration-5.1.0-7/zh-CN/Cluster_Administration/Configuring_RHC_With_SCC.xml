<?xml version='1.0'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % RH_ENTITIES SYSTEM "Common_Content/Entities.ent">
%RH_ENTITIES;
<!ENTITY % RH_TRANS_ENTITIES SYSTEM "Common_Content/Translatable-Entities.ent">
%RH_TRANS_ENTITIES;
]>

<chapter id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster">
	<title>Configuring &RH; Cluster With <command>system-config-cluster</command></title>
	<indexterm>
		<primary>cluster software installation and configuration</primary>
	</indexterm>
	<indexterm>
		<primary>cluster software</primary>
		<secondary>installation and configuration</secondary>
	</indexterm>
	<para>
		This chapter describes how to configure &RH; Cluster software using <command>system-config-cluster</command>, and consists of the following sections:
	</para>
	<itemizedlist>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuration_Tasks" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_RHCLUSTERTOOL" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Naming_The_Cluster" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_Fence_Devices" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_and_Deleting_Members" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_a_Failover_Domain" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_Cluster_Resources" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_a_Cluster_Service_to_the_Cluster" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Propagating_The_Configuration_File_New_Cluster" />
			</para>
		</listitem>
		<listitem>
			<para>
				<xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_Cluster_Software" />
			</para>
		</listitem>
	</itemizedlist>
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuration_Tasks">
		<title>Configuration Tasks</title>
		<para>
			Configuring &RH; Cluster software with <command>system-config-cluster</command> consists of the following steps:
		</para>
		<orderedlist>
			<listitem>
				<para>
					Starting the <application>&RHCLUSTERTOOL;</application>, <command>system-config-cluster</command>. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_RHCLUSTERTOOL" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Naming the cluster. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Naming_The_Cluster" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Creating fence devices. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_Fence_Devices" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Creating cluster members. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_and_Deleting_Members" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Creating failover domains. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_a_Failover_Domain" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Creating resources. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_Cluster_Resources" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Creating cluster services.
				</para>
				<para>
					Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_a_Cluster_Service_to_the_Cluster" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Propagating the configuration file to the other nodes in the cluster.
				</para>
				<para>
					Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Propagating_The_Configuration_File_New_Cluster" />.
				</para>
			</listitem>
			<listitem>
				<para>
					Starting the cluster software. Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_Cluster_Software" />.
				</para>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_RHCLUSTERTOOL">
		<title>Starting the <application>&RHCLUSTERTOOL;</application></title>
		<para>
			You can start the <application>&RHCLUSTERTOOL;</application> by logging in to a cluster node as root with the <command>ssh -Y</command> command and issuing the <command>system-config-cluster</command> command. For example, to start the <application>&RHCLUSTERTOOL;</application> on cluster node nano-01, do the following:
		</para>
		<orderedlist>
			<listitem>
				<para>
					Log in to a cluster node and run <command>system-config-cluster</command>. For example:
				</para>
<screen>
$ <userinput> ssh -Y root@nano-01</userinput>
  .
  .
  .
# <userinput>system-config-cluster</userinput></screen>
			</listitem>
			<listitem>
				<para>
					If this is the first time you have started the <application>&RHCLUSTERTOOL;</application>, the program prompts you to either open an existing configuration or create a new one. Click <guibutton>Create New Configuration</guibutton> to start a new configuration file (refer to <xref linkend="Cluster_Administration-Starting_the_RHCLUSTERTOOL-Starting_a_New_Configuration_File" />).
				</para>
				<figure id="Cluster_Administration-Starting_the_RHCLUSTERTOOL-Starting_a_New_Configuration_File">
					<title>Starting a New Configuration File</title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="./images/cluconfig-new-5.0.png" />
						</imageobject>
						<textobject>
							<para>
								Starting a New Configuration File.
							</para>
						</textobject>
					</mediaobject>
				</figure>
				<note>
					<title>Note</title>
					<para>
						The <guimenu>Cluster Management</guimenu> tab for the &RHCS; management GUI is available after you save the configuration file with the <application>&RHCLUSTERTOOL;</application>, exit, and restart the the &RHCS; management GUI (<command>system-config-cluster</command>). (The <guimenu>Cluster Management</guimenu> tab displays the status of the cluster service manager, cluster nodes, and resources, and shows statistics concerning cluster service operation. To manage the cluster system further, choose the <guimenu>Cluster Configuration</guimenu> tab.)
					</para>
				</note>
			</listitem>
			<listitem>
				<para>
					Clicking <guibutton>Create New Configuration</guibutton> causes the <guilabel>New Configuration</guilabel> dialog box to be displayed (refer to <xref linkend="Cluster_Administration-Starting_the_RHCLUSTERTOOL-Creating_A_New_Configuration" />). The <guilabel>New Configuration</guilabel> dialog box provides a text box for cluster name and the following checkboxes: <guimenu>Custom Configure Multicast</guimenu> and <guimenu>Use a Quorum disk</guimenu>. In most circumstances you only need to configure the cluster name. &RH; Cluster software chooses a multicast address for cluster management communication among cluster nodes. If you need to use a specific multicast address, click the <guimenu>Custom Configure Multicast</guimenu> checkbox and enter a multicast address in the <guimenu>Address</guimenu> text boxes. If you need to use a quorum disk, click the <guimenu>Use a Quorum disk</guimenu> checkbox and enter quorum disk parameters. For information about quorum disk parameters, refer to the <citerefentry><refentrytitle>qdisk</refentrytitle><manvolnum>8</manvolnum></citerefentry> man page.
				</para>
				<figure id="Cluster_Administration-Starting_the_RHCLUSTERTOOL-Creating_A_New_Configuration">
					<title>Creating A New Configuration</title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="./images/cluconfig-newconfig-5.0.png" />
						</imageobject>
						<textobject>
							<para>
								New Configuration
							</para>
						</textobject>
					</mediaobject>
				</figure>
			</listitem>
			<listitem>
				<para>
					When you have completed entering the cluster name and other parameters in the <guilabel>New Configuration</guilabel> dialog box, click <guibutton>OK</guibutton>. Clicking <guibutton>OK</guibutton> starts the <application>&RHCLUSTERTOOL;</application>, displaying a graphical representation of the configuration (<xref linkend="Cluster_Administration-Starting_the_RHCLUSTERTOOL-The_RHCLUSTERTOOL" />).
				</para>
				<figure id="Cluster_Administration-Starting_the_RHCLUSTERTOOL-The_RHCLUSTERTOOL">
					<title>The <application>&RHCLUSTERTOOL;</application></title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="./images/cluconfig-start.png" />
						</imageobject>
						<textobject>
							<para>
								The <application>&RHCLUSTERTOOL;</application>.
							</para>
						</textobject>
					</mediaobject>
				</figure>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Naming_The_Cluster">
		<title>Naming The Cluster</title>
		<para>
			Naming the cluster consists of specifying a cluster name, a configuration version (optional), and values for <guimenu>Post-Join Delay</guimenu> and <guimenu>Post-Fail Delay</guimenu>. Name the cluster as follows:
		</para>
		<orderedlist>
			<listitem>
				<para>
					At the left frame, click <guimenu>Cluster</guimenu>.
				</para>
			</listitem>
			<listitem>
				<para>
					At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Edit Cluster Properties</guibutton> button. Clicking that button causes a <guilabel>Cluster Properties</guilabel> dialog box to be displayed. The <guilabel>Cluster Properties</guilabel> dialog box presents text boxes for <guimenu>Name</guimenu>, <guimenu>Config Version</guimenu>, and two <guimenu>Fence Daemon Properties</guimenu> parameters: <guimenu>Post-Join Delay</guimenu> and <guimenu>Post-Fail Delay</guimenu>.
				</para>
			</listitem>
			<listitem>
				<para>
					At the <guimenu>Cluster Alias</guimenu> text box, specify a name for the cluster. The name should be descriptive enough to distinguish it from other clusters and systems on your network (for example, <userinput>nfs_cluster</userinput> or <userinput>httpd_cluster</userinput>). The cluster name cannot exceed 15 characters.
				</para>
				<tip>
					<title>Tip</title>
					<para>
						Choose the cluster name carefully. The only way to change the name of a Red Hat cluster is to create a new cluster configuration with the new name.
					</para>
				</tip>
			</listitem>
			<listitem>
				<para>
					(Optional) The <guimenu>Config Version</guimenu> value is set to <userinput>1</userinput> by default and is automatically incremented each time you save your cluster configuration. However, if you need to set it to another value, you can specify it at the <guimenu>Config Version</guimenu> text box.
				</para>
			</listitem>
			<listitem>
				<para>
					Specify the <guimenu>Fence Daemon Properties</guimenu> parameters: <guimenu>Post-Join Delay</guimenu> and <guimenu>Post-Fail Delay</guimenu>.
				</para>
				<orderedlist>
					<listitem>
						<para>
							The <guimenu>Post-Join Delay</guimenu> parameter is the number of seconds the fence daemon (<command>fenced</command>) waits before fencing a node after the node joins the fence domain. The <guimenu>Post-Join Delay</guimenu> default value is <userinput>3</userinput>. A typical setting for <guimenu>Post-Join Delay</guimenu> is between 20 and 30 seconds, but can vary according to cluster and network performance.
						</para>
					</listitem>
					<listitem>
						<para>
							The <guimenu>Post-Fail Delay</guimenu> parameter is the number of seconds the fence daemon (<command>fenced</command>) waits before fencing a node (a member of the fence domain) after the node has failed.The <guimenu>Post-Fail Delay</guimenu> default value is <userinput>0</userinput>. Its value may be varied to suit cluster and network performance.
						</para>
					</listitem>
				</orderedlist>
				<note>
					<title>Note</title>
					<para>
						For more information about <guimenu>Post-Join Delay</guimenu> and <guimenu>Post-Fail Delay</guimenu>, refer to the <citerefentry><refentrytitle>fenced</refentrytitle><manvolnum>8</manvolnum></citerefentry> man page.
					</para>
				</note>
			</listitem>
			<listitem>
				<para>
					Save cluster configuration changes by selecting <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem>.
				</para>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_Fence_Devices">
		<title>Configuring Fence Devices</title>
		<para>
			Configuring fence devices for the cluster consists of selecting one or more fence devices and specifying fence-device-dependent parameters (for example, name, IP address, login, and password).
		</para>
		<para>
			To configure fence devices, follow these steps:
		</para>
		<orderedlist>
			<listitem>
				<para>
					Click <guimenu>Fence Devices</guimenu>. At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Add a Fence Device</guibutton> button. Clicking <guibutton> Add a Fence Device</guibutton> causes the <guilabel>Fence Device Configuration</guilabel> dialog box to be displayed (refer to <xref linkend="Cluster_Administration-Configuring_Fence_Devices-Fence_Device_Configuration" />).
				</para>
				<figure id="Cluster_Administration-Configuring_Fence_Devices-Fence_Device_Configuration">
					<title>Fence Device Configuration</title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="./images/fence-device-config-dbox.png" />
						</imageobject>
						<textobject>
							<para>
								fence configuration dialog box
							</para>
						</textobject>
					</mediaobject>
				</figure>
			</listitem>
			<listitem>
				<para>
					At the <guilabel>Fence Device Configuration</guilabel> dialog box, click the drop-down box under <guimenu>Add a New Fence Device</guimenu> and select the type of fence device to configure.
				</para>
			</listitem>
			<listitem>
				<para>
					Specify the information in the <guilabel>Fence Device Configuration</guilabel> dialog box according to the type of fence device. Refer to <xref linkend="Cluster_Administration-Fence_Device_Parameters" /> for more information about fence device parameters.
				</para>
			</listitem>
			<listitem>
				<para>
					Click <guibutton>OK</guibutton>.
				</para>
			</listitem>
			<listitem>
				<para>
					Choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
				</para>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_and_Deleting_Members">
		<title>Adding and Deleting Members</title>
		<para>
			The procedure to add a member to a cluster varies depending on whether the cluster is a newly-configured cluster or a cluster that is already configured and running. To add a member to a new cluster, refer to <xref linkend="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Cluster" />. To add a member to an existing cluster, refer to <xref linkend="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Running_Cluster" />. To delete a member from a cluster, refer to <xref linkend="Cluster_Administration-Adding_and_Deleting_Members-Deleting_a_Member_from_a_Cluster" />.
		</para>
		<section id="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Cluster">
			<title>Adding a Member to a Cluster</title>
			<para>
				To add a member to a new cluster, follow these steps:
			</para>
			<orderedlist>
				<listitem>
					<para>
						Click <guimenu>Cluster Node</guimenu>.
					</para>
				</listitem>
				<listitem>
					<para>
						At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Add a Cluster Node</guibutton> button. Clicking that button causes a <guilabel>Node Properties</guilabel> dialog box to be displayed. The <guilabel>Node Properties</guilabel> dialog box presents text boxes for <guimenu>Cluster Node Name</guimenu> and <guimenu>Quorum Votes</guimenu> (refer to <xref linkend="Cluster_Administration-Adding_a_Member_to_a_Cluster-Adding_a_Member_to_a_New_Cluster" />).
					</para>
					<figure id="Cluster_Administration-Adding_a_Member_to_a_Cluster-Adding_a_Member_to_a_New_Cluster">
						<title>Adding a Member to a New Cluster</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="./images/newmember-dlm.png" />
							</imageobject>
							<textobject>
								<para>
									new member dialog
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</listitem>
				<listitem>
					<para>
						At the <guimenu>Cluster Node Name</guimenu> text box, specify a node name. The entry can be a name or an IP address of the node on the cluster subnet.
					</para>
					<note>
						<title>Note</title>
						<para>
							Each node must be on the same subnet as the node from which you are running the <application>&RHCLUSTERTOOL;</application> and must be defined either in DNS or in the <filename>/etc/hosts</filename> file of each cluster node.
						</para>
					</note>
					<note>
						<title>Note</title>
						<para>
							The node on which you are running the <application>&RHCLUSTERTOOL;</application> must be explicitly added as a cluster member; the node is not automatically added to the cluster configuration as a result of running the <application>&RHCLUSTERTOOL;</application>.
						</para>
					</note>
				</listitem>
				<listitem>
					<para>
						Optionally, at the <guimenu>Quorum Votes</guimenu> text box, you can specify a value; however in most configurations you can leave it blank. Leaving the <guimenu>Quorum Votes</guimenu> text box blank causes the quorum votes value for that node to be set to the default value of <userinput>1</userinput>.
					</para>
				</listitem>
				<listitem>
					<para>
						Click <guibutton>OK</guibutton>.
					</para>
				</listitem>
				<listitem>
					<para>
						Configure fencing for the node:
					</para>
					<orderedlist>
						<listitem>
							<para>
								Click the node that you added in the previous step.
							</para>
						</listitem>
						<listitem>
							<para>
								At the bottom of the right frame (below <guimenu>Properties</guimenu>), click <guibutton>Manage Fencing For This Node</guibutton>. Clicking <guibutton>Manage Fencing For This Node</guibutton> causes the <guilabel>Fence Configuration</guilabel> dialog box to be displayed.
							</para>
						</listitem>
						<listitem>
							<para>
								At the <guilabel>Fence Configuration</guilabel> dialog box, bottom of the right frame (below <guimenu>Properties</guimenu>), click <guibutton>Add a New Fence Level</guibutton>. Clicking <guibutton>Add a New Fence Level</guibutton> causes a fence-level element (for example, <guimenu>Fence-Level-1</guimenu>, <guimenu>Fence-Level-2</guimenu>, and so on) to be displayed below the node in the left frame of the <guilabel>Fence Configuration</guilabel> dialog box.
							</para>
						</listitem>
						<listitem>
							<para>
								Click the fence-level element.
							</para>
						</listitem>
						<listitem>
							<para>
								At the bottom of the right frame (below <guimenu>Properties</guimenu>), click <guibutton>Add a New Fence to this Level</guibutton>. Clicking <guibutton>Add a New Fence to this Level</guibutton> causes the <guilabel>Fence Properties</guilabel> dialog box to be displayed.
							</para>
						</listitem>
						<listitem>
							<para>
								At the <guilabel>Fence Properties</guilabel> dialog box, click the <guimenu>Fence Device Type</guimenu> drop-down box and select the fence device for this node. Also, provide additional information required (for example, <guimenu>Port</guimenu> and <guimenu>Switch</guimenu> for an APC Power Device).
							</para>
						</listitem>
						<listitem>
							<para>
								At the <guilabel>Fence Properties</guilabel> dialog box, click <guibutton>OK</guibutton>. Clicking <guibutton>OK</guibutton> causes a fence device element to be displayed below the fence-level element.
							</para>
						</listitem>
						<listitem>
							<para>
								To create additional fence devices at this fence level, return to step 6d. Otherwise, proceed to the next step.
							</para>
						</listitem>
						<listitem>
							<para>
								To create additional fence levels, return to step 6c. Otherwise, proceed to the next step.
							</para>
						</listitem>
						<listitem>
							<para>
								If you have configured all the fence levels and fence devices for this node, click <guibutton>Close</guibutton>.
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						Choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
					</para>
				</listitem>
			</orderedlist>
		</section>
		
		<section id="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Running_Cluster">
			<title>Adding a Member to a Running Cluster</title>
			<para>
				The procedure for adding a member to a running cluster depends on whether the cluster contains only two nodes or more than two nodes. To add a member to a running cluster, follow the steps in one of the following sections according to the number of nodes in the cluster:
			</para>
			<itemizedlist>
				<listitem>
					<para>
						For clusters with <emphasis>only</emphasis> two nodes &mdash;
					</para>
					<para>
						<xref linkend="Cluster_Administration-Adding_a_Member_to_a_Running_Cluster-Adding_a_Member_to_a_Running_Cluster_That_Contains__________Only_Two_Nodes" />
					</para>
				</listitem>
				<listitem>
					<para>
						For clusters with <emphasis>more than</emphasis> two nodes &mdash;
					</para>
					<para>
						<xref linkend="Cluster_Administration-Adding_a_Member_to_a_Running_Cluster-Adding_a_Member_to_a_Running_Cluster_That_Contains_More__________Than_Two_Nodes" />
					</para>
				</listitem>
			</itemizedlist>
			<section id="Cluster_Administration-Adding_a_Member_to_a_Running_Cluster-Adding_a_Member_to_a_Running_Cluster_That_Contains__________Only_Two_Nodes">
				<title>Adding a Member to a Running Cluster That Contains <emphasis>Only</emphasis> Two Nodes</title>
				<para>
					To add a member to an existing cluster that is currently in operation, and contains <emphasis>only</emphasis> two nodes, follow these steps:
				</para>
				<orderedlist>
					<listitem>
						<para>
							Add the node and configure fencing for it as in
						</para>
						<para>
							<xref linkend="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Cluster" />.
						</para>
					</listitem>
					<listitem>
						<para>
							Click <guibutton>Send to Cluster</guibutton> to propagate the updated configuration to other running nodes in the cluster.
						</para>
					</listitem>
					<listitem>
						<para>
							Use the <command>scp</command> command to send the updated <filename>/etc/cluster/cluster.conf</filename> file from one of the existing cluster nodes to the new node.
						</para>
					</listitem>
					<listitem>
						<para>
							At the &RHCS; management GUI <application>&RHCLUSTERSTATTOOL;</application> tab, disable each service listed under <guimenu>Services</guimenu>.
						</para>
					</listitem>
					<listitem>
						<para>
							Stop the cluster software on the two running nodes by running the following commands at each node in this order:
						</para>
						<orderedlist>
							<listitem>
								<para>
									<command>service rgmanager stop</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service gfs stop</command>, if you are using &RHGFS;
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service clvmd stop</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service cman stop</command>
								</para>
							</listitem>
						</orderedlist>
					</listitem>
					<listitem>
						<para>
							Start cluster software on all cluster nodes (including the added one) by running the following commands in this order:
						</para>
						<orderedlist>
							<listitem>
								<para>
									<command>service cman start</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service clvmd start</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service gfs start</command>, if you are using &RHGFS;
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service rgmanager start</command>
								</para>
							</listitem>
						</orderedlist>
					</listitem>
					<listitem>
						<para>
							Start the &RHCS; management GUI. At the <application>&RHCLUSTERTOOL;</application> tab, verify that the configuration is correct. At the <application>&RHCLUSTERSTATTOOL;</application> tab verify that the nodes and services are running as expected.
						</para>
					</listitem>
				</orderedlist>
			</section>
			
			<section id="Cluster_Administration-Adding_a_Member_to_a_Running_Cluster-Adding_a_Member_to_a_Running_Cluster_That_Contains_More__________Than_Two_Nodes">
				<title>Adding a Member to a Running Cluster That Contains <emphasis>More Than</emphasis> Two Nodes</title>
				<para>
					To add a member to an existing cluster that is currently in operation, and contains <emphasis>more than</emphasis> two nodes, follow these steps:
				</para>
				<orderedlist>
					<listitem>
						<para>
							Add the node and configure fencing for it as in
						</para>
						<para>
							<xref linkend="Cluster_Administration-Adding_and_Deleting_Members-Adding_a_Member_to_a_Cluster" />.
						</para>
					</listitem>
					<listitem>
						<para>
							Click <guibutton>Send to Cluster</guibutton> to propagate the updated configuration to other running nodes in the cluster.
						</para>
					</listitem>
					<listitem>
						<para>
							Use the <command>scp</command> command to send the updated <filename>/etc/cluster/cluster.conf</filename> file from one of the existing cluster nodes to the new node.
						</para>
					</listitem>
					<listitem>
						<para>
							Start cluster services on the new node by running the following commands in this order:
						</para>
						<orderedlist>
							<listitem>
								<para>
									<command> service cman start</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service clvmd start</command>
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service gfs start</command>, if you are using &RHGFS;
								</para>
							</listitem>
							<listitem>
								<para>
									<command>service rgmanager start</command>
								</para>
							</listitem>
						</orderedlist>
					</listitem>
					<listitem>
						<para>
							Start the &RHCS; management GUI. At the <application>&RHCLUSTERTOOL;</application> tab, verify that the configuration is correct. At the <application>&RHCLUSTERSTATTOOL;</application> tab verify that the nodes and services are running as expected.
						</para>
					</listitem>
				</orderedlist>
			</section>

		</section>
		
		<section id="Cluster_Administration-Adding_and_Deleting_Members-Deleting_a_Member_from_a_Cluster">
			<title>Deleting a Member from a Cluster</title>
			<para>
				To delete a member from an existing cluster that is currently in operation, follow these steps:
			</para>
			<orderedlist>
				<listitem>
					<para>
						At one of the running nodes (not to be removed), run the &RHCS; management GUI. At the <application>&RHCLUSTERSTATTOOL;</application> tab, under <guimenu>Services</guimenu>, disable or relocate each service that is running on the node to be deleted.
					</para>
				</listitem>
				<listitem>
					<para>
						Stop the cluster software on the node to be deleted by running the following commands at that node in this order:
					</para>
					<orderedlist>
						<listitem>
							<para>
								<command>service rgmanager stop</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service gfs stop</command>, if you are using &RHGFS;
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service clvmd stop</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command> service cman stop</command>
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						At the <application>&RHCLUSTERTOOL;</application> (on one of the running members), delete the member as follows:
					</para>
					<orderedlist>
						<listitem>
							<para>
								If necessary, click the triangle icon to expand the <guimenu>Cluster Nodes</guimenu> property.
							</para>
						</listitem>
						<listitem>
							<para>
								Select the cluster node to be deleted. At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Delete Node</guibutton> button.
							</para>
						</listitem>
						<listitem>
							<para>
								Clicking the <guibutton>Delete Node</guibutton> button causes a warning dialog box to be displayed requesting confirmation of the deletion (<xref linkend="Cluster_Administration-Deleting_a_Member_from_a_Cluster-Confirm_Deleting_a_Member" />).
							</para>
							<figure id="Cluster_Administration-Deleting_a_Member_from_a_Cluster-Confirm_Deleting_a_Member">
								<title>Confirm Deleting a Member</title>
								<mediaobject>
									<imageobject>
										<imagedata fileref="./images/deletemember.png" />
									</imageobject>
									<textobject>
										<para>
											delete member box
										</para>
									</textobject>
								</mediaobject>
							</figure>
						</listitem>
						<listitem>
							<para>
								At that dialog box, click <guibutton>Yes</guibutton> to confirm deletion.
							</para>
						</listitem>
						<listitem>
							<para>
								Propagate the updated configuration by clicking the <guibutton>Send to Cluster</guibutton> button. (Propagating the updated configuration automatically saves the configuration.)
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						Stop the cluster software on the remaining running nodes by running the following commands at each node in this order:
					</para>
					<orderedlist>
						<listitem>
							<para>
								<command>service rgmanager stop</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service gfs stop</command>, if you are using &RHGFS;
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service clvmd stop</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command> service cman stop</command>
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						Start cluster software on all remaining cluster nodes by running the following commands in this order:
					</para>
					<orderedlist>
						<listitem>
							<para>
								<command> service cman start</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service clvmd start</command>
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service gfs start</command>, if you are using &RHGFS;
							</para>
						</listitem>
						<listitem>
							<para>
								<command>service rgmanager start</command>
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						Start the &RHCS; management GUI. At the <application>&RHCLUSTERTOOL;</application> tab, verify that the configuration is correct. At the <application>&RHCLUSTERSTATTOOL;</application> tab verify that the nodes and services are running as expected.
					</para>
				</listitem>
			</orderedlist>
		</section>

	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_a_Failover_Domain">
		<title>Configuring a Failover Domain</title>
		<para>
			A failover domain is a named subset of cluster nodes that are eligible to run a cluster service in the event of a node failure. A failover domain can have the following characteristics:
		</para>
		<itemizedlist>
			<listitem>
				<para>
					Unrestricted &mdash; Allows you to specify that a subset of members are preferred, but that a cluster service assigned to this domain can run on any available member.
				</para>
			</listitem>
			<listitem>
				<para>
					Restricted &mdash; Allows you to restrict the members that can run a particular cluster service. If none of the members in a restricted failover domain are available, the cluster service cannot be started (either manually or by the cluster software).
				</para>
			</listitem>
			<listitem>
				<para>
					Unordered &mdash; When a cluster service is assigned to an unordered failover domain, the member on which the cluster service runs is chosen from the available failover domain members with no priority ordering.
				</para>
			</listitem>
			<listitem>
				<para>
					Ordered &mdash; Allows you to specify a preference order among the members of a failover domain. The member at the top of the list is the most preferred, followed by the second member in the list, and so on.
				</para>
			</listitem>
		</itemizedlist>
		<note>
			<title>Note</title>
			<para>
				Changing a failover domain configuration has no effect on currently running services.
			</para>
		</note>
		<note>
			<title>Note</title>
			<para>
				Failover domains are <emphasis>not</emphasis> required for operation.
			</para>
		</note>
		<para>
			By default, failover domains are unrestricted and unordered.
		</para>
		<para>
			In a cluster with several members, using a restricted failover domain can minimize the work to set up the cluster to run a cluster service (such as <filename>httpd</filename>), which requires you to set up the configuration identically on all members that run the cluster service). Instead of setting up the entire cluster to run the cluster service, you must set up only the members in the restricted failover domain that you associate with the cluster service.
		</para>
		<tip>
			<title>Tip</title>
			<para>
				To configure a preferred member, you can create an unrestricted failover domain comprising only one cluster member. Doing that causes a cluster service to run on that cluster member primarily (the preferred member), but allows the cluster service to fail over to any of the other members.
			</para>
		</tip>
		<para>
			The following sections describe adding a failover domain, removing a failover domain, and removing members from a failover domain:
		</para>
		<itemizedlist>
			<listitem>
				<para>
					<xref linkend="Cluster_Administration-Configuring_a_Failover_Domain-Adding_a_Failover_Domain" />
				</para>
			</listitem>
			<listitem>
				<para>
					<xref linkend="Cluster_Administration-Configuring_a_Failover_Domain-Removing_a_Failover_Domain" />
				</para>
			</listitem>
			<listitem>
				<para>
					<xref linkend="Cluster_Administration-Configuring_a_Failover_Domain-Removing_a_Member_from_a_Failover_Domain" />
				</para>
			</listitem>
		</itemizedlist>
		<section id="Cluster_Administration-Configuring_a_Failover_Domain-Adding_a_Failover_Domain">
			<title>Adding a Failover Domain</title>
			<para>
				To add a failover domain, follow these steps:
			</para>
			<orderedlist>
				<listitem>
					<para>
						At the left frame of the the <application>&RHCLUSTERTOOL;</application>, click <guimenu>Failover Domains</guimenu>.
					</para>
				</listitem>
				<listitem>
					<para>
						At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Create a Failover Domain</guibutton> button. Clicking the <guibutton>Create a Failover Domain</guibutton> button causes the <guilabel>Add Failover Domain</guilabel> dialog box to be displayed.
					</para>
				</listitem>
				<listitem>
					<para>
						At the <guilabel>Add Failover Domain</guilabel> dialog box, specify a failover domain name at the <guimenu>Name for new Failover Domain</guimenu> text box and click <guibutton>OK</guibutton>. Clicking <guibutton>OK</guibutton> causes the <guilabel>Failover Domain Configuration</guilabel> dialog box to be displayed (<xref linkend="Cluster_Administration-Adding_a_Failover_Domain-Failover_Domain_Configuration_Configuring_a______________Failover_Domain" />).
					</para>
					<note>
						<title>Note</title>
						<para>
							The name should be descriptive enough to distinguish its purpose relative to other names used in your cluster.
						</para>
					</note>
					<figure id="Cluster_Administration-Adding_a_Failover_Domain-Failover_Domain_Configuration_Configuring_a______________Failover_Domain">
						<title><guimenu>Failover Domain Configuration</guimenu>: Configuring a Failover Domain</title>
						<mediaobject>
							<imageobject>
								<imagedata fileref="./images/failoverdn.png" />
							</imageobject>
							<textobject>
								<para>
									failover dialog box
								</para>
							</textobject>
						</mediaobject>
					</figure>
				</listitem>
				<listitem>
					<para>
						Click the <guimenu>Available Cluster Nodes</guimenu> drop-down box and select the members for this failover domain.
					</para>
				</listitem>
				<listitem>
					<para>
						To restrict failover to members in this failover domain, click (check) the <guimenu>Restrict Failover To This Domains Members</guimenu> checkbox. (With <guimenu>Restrict Failover To This Domains Members</guimenu> checked, services assigned to this failover domain fail over only to nodes in this failover domain.)
					</para>
				</listitem>
				<listitem>
					<para>
						To prioritize the order in which the members in the failover domain assume control of a failed cluster service, follow these steps:
					</para>
					<orderedlist>
						<listitem>
							<para>
								Click (check) the <guimenu>Prioritized List</guimenu> checkbox (<xref linkend="Cluster_Administration-Adding_a_Failover_Domain-Failover_Domain_Configuration_Adjusting_Priority" />). Clicking <guimenu>Prioritized List</guimenu> causes the <guimenu>Priority</guimenu> column to be displayed next to the <guimenu>Member Node</guimenu> column.
							</para>
							<figure id="Cluster_Administration-Adding_a_Failover_Domain-Failover_Domain_Configuration_Adjusting_Priority">
								<title><guimenu>Failover Domain Configuration</guimenu>: Adjusting Priority</title>
								<mediaobject>
									<imageobject>
										<imagedata fileref="./images/failoverdn-pri.png" />
									</imageobject>
									<textobject>
										<para>
											failover dialog box priority
										</para>
									</textobject>
								</mediaobject>
							</figure>
						</listitem>
						<listitem>
							<para>
								For each node that requires a priority adjustment, click the node listed in the <guimenu>Member Node/Priority</guimenu> columns and adjust priority by clicking one of the <guimenu>Adjust Priority</guimenu> arrows. Priority is indicated by the position in the <guimenu>Member Node</guimenu> column and the value in the <guimenu>Priority</guimenu> column. The node priorities are listed highest to lowest, with the highest priority node at the top of the <guimenu>Member Node</guimenu> column (having the lowest <guimenu>Priority</guimenu> number).
							</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>
						Click <guibutton>Close</guibutton> to create the domain.
					</para>
				</listitem>
				<listitem>
					<para>
						At the <application>&RHCLUSTERTOOL;</application>, perform one of the following actions depending on whether the configuration is for a new cluster or for one that is operational and running:
					</para>
					<itemizedlist>
						<listitem>
							<para>
								New cluster &mdash; If this is a new cluster, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
						<listitem>
							<para>
								Running cluster &mdash; If this cluster is operational and running, and you want to propagate the change immediately, click the <guibutton>Send to Cluster</guibutton> button. Clicking <guibutton>Send to Cluster</guibutton> automatically saves the configuration change. If you do not want to propagate the change immediately, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
					</itemizedlist>
				</listitem>
			</orderedlist>
		</section>
		
		<section id="Cluster_Administration-Configuring_a_Failover_Domain-Removing_a_Failover_Domain">
			<title>Removing a Failover Domain</title>
			<para>
				To remove a failover domain, follow these steps:
			</para>
			<orderedlist>
				<listitem>
					<para>
						At the left frame of the the <application>&RHCLUSTERTOOL;</application>, click the failover domain that you want to delete (listed under <guimenu>Failover Domains</guimenu>).
					</para>
				</listitem>
				<listitem>
					<para>
						At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Delete Failover Domain</guibutton> button. Clicking the <guibutton>Delete Failover Domain</guibutton> button causes a warning dialog box do be displayed asking if you want to remove the failover domain. Confirm that the failover domain identified in the warning dialog box is the one you want to delete and click <guibutton>Yes</guibutton>. Clicking <guibutton>Yes</guibutton> causes the failover domain to be removed from the list of failover domains under <guimenu>Failover Domains</guimenu> in the left frame of the <application>&RHCLUSTERTOOL;</application>.
					</para>
				</listitem>
				<listitem>
					<para>
						At the <application>&RHCLUSTERTOOL;</application>, perform one of the following actions depending on whether the configuration is for a new cluster or for one that is operational and running:
					</para>
					<itemizedlist>
						<listitem>
							<para>
								New cluster &mdash; If this is a new cluster, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
						<listitem>
							<para>
								Running cluster &mdash; If this cluster is operational and running, and you want to propagate the change immediately, click the <guibutton>Send to Cluster</guibutton> button. Clicking <guibutton>Send to Cluster</guibutton> automatically saves the configuration change. If you do not want to propagate the change immediately, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
					</itemizedlist>
				</listitem>
			</orderedlist>
		</section>
		
		<section id="Cluster_Administration-Configuring_a_Failover_Domain-Removing_a_Member_from_a_Failover_Domain">
			<title>Removing a Member from a Failover Domain</title>
			<para>
				To remove a member from a failover domain, follow these steps:
			</para>
			<orderedlist>
				<listitem>
					<para>
						At the left frame of the the <application>&RHCLUSTERTOOL;</application>, click the failover domain that you want to change (listed under <guimenu>Failover Domains</guimenu>).
					</para>
				</listitem>
				<listitem>
					<para>
						At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Edit Failover Domain Properties</guibutton> button. Clicking the <guibutton>Edit Failover Domain Properties</guibutton> button causes the <guilabel>Failover Domain Configuration</guilabel> dialog box to be displayed (<xref linkend="Cluster_Administration-Adding_a_Failover_Domain-Failover_Domain_Configuration_Configuring_a______________Failover_Domain" />).
					</para>
				</listitem>
				<listitem>
					<para>
						At the <guilabel>Failover Domain Configuration</guilabel> dialog box, in the <guimenu>Member Node</guimenu> column, click the node name that you want to delete from the failover domain and click the <guibutton>Remove Member from Domain</guibutton> button. Clicking <guibutton>Remove Member from Domain</guibutton> removes the node from the <guimenu>Member Node</guimenu> column. Repeat this step for each node that is to be deleted from the failover domain. (Nodes must be deleted one at a time.)
					</para>
				</listitem>
				<listitem>
					<para>
						When finished, click <guibutton>Close</guibutton>.
					</para>
				</listitem>
				<listitem>
					<para>
						At the <application>&RHCLUSTERTOOL;</application>, perform one of the following actions depending on whether the configuration is for a new cluster or for one that is operational and running:
					</para>
					<itemizedlist>
						<listitem>
							<para>
								New cluster &mdash; If this is a new cluster, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
						<listitem>
							<para>
								Running cluster &mdash; If this cluster is operational and running, and you want to propagate the change immediately, click the <guibutton>Send to Cluster</guibutton> button. Clicking <guibutton>Send to Cluster</guibutton> automatically saves the configuration change. If you do not want to propagate the change immediately, choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
							</para>
						</listitem>
					</itemizedlist>
				</listitem>
			</orderedlist>
		</section>

	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_Cluster_Resources">
		<title>Adding Cluster Resources</title>
		<para>
			To specify a device for a cluster service, follow these steps:
		</para>
		<orderedlist>
			<listitem>
				<para>
					On the <guimenu>Resources</guimenu> property of the <application>&RHCLUSTERTOOL;</application>, click the <guibutton>Create a Resource</guibutton> button. Clicking the <guibutton>Create a Resource</guibutton> button causes the <guilabel>Resource Configuration</guilabel> dialog box to be displayed.
				</para>
			</listitem>
			<listitem>
				<para>
					At the <guilabel>Resource Configuration</guilabel> dialog box, under <guimenu>Select a Resource Type</guimenu>, click the drop-down box. At the drop-down box, select a resource to configure. The resource options are described as follows:
				</para>
				<variablelist>
					<varlistentry>
						<term>GFS</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Create a name for the file system resource.
							</para>
							<para>
								<guimenu>Mount Point</guimenu> &mdash; Choose the path to which the file system resource is mounted.
							</para>
							<para>
								<guimenu>Device</guimenu> &mdash; Specify the device file associated with the file system resource.
							</para>
							<para>
								<guimenu>Options</guimenu> &mdash; Mount options.
							</para>
							<para>
								<guimenu>File System ID</guimenu> &mdash; When creating a new file system resource, you can leave this field blank. Leaving the field blank causes a file system ID to be assigned automatically after you click <guibutton>OK</guibutton> at the <guilabel>Resource Configuration</guilabel> dialog box. If you need to assign a file system ID explicitly, specify it in this field.
							</para>
							<para>
								<guimenu>Force Unmount</guimenu> checkbox &mdash; If checked, forces the file system to unmount. The default setting is unchecked. <guimenu>Force Unmount</guimenu> kills all processes using the mount point to free up the mount when it tries to unmount. With GFS resources, the mount point is <emphasis>not</emphasis> unmounted at service tear-down <emphasis>unless</emphasis> this box is checked.
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>File System</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Create a name for the file system resource.
							</para>
							<para>
								<guimenu>File System Type</guimenu> &mdash; Choose the file system for the resource using the drop-down menu.
							</para>
							<para>
								<guimenu>Mount Point</guimenu> &mdash; Choose the path to which the file system resource is mounted.
							</para>
							<para>
								<guimenu>Device</guimenu> &mdash; Specify the device file associated with the file system resource.
							</para>
							<para>
								<guimenu>Options</guimenu> &mdash; Mount options.
							</para>
							<para>
								<guimenu>File System ID</guimenu> &mdash; When creating a new file system resource, you can leave this field blank. Leaving the field blank causes a file system ID to be assigned automatically after you click <guibutton>OK</guibutton> at the <guilabel>Resource Configuration</guilabel> dialog box. If you need to assign a file system ID explicitly, specify it in this field.
							</para>
							<para>
								Checkboxes &mdash; Specify mount and unmount actions when a service is stopped (for example, when disabling or relocating a service):
							</para>
							<itemizedlist>
								<listitem>
									<para>
										<guimenu>Force unmount</guimenu> &mdash; If checked, forces the file system to unmount. The default setting is unchecked. <guimenu>Force Unmount</guimenu> kills all processes using the mount point to free up the mount when it tries to unmount.
									</para>
								</listitem>
								<listitem>
									<para>
										<guimenu>Reboot host node if unmount fails</guimenu> &mdash; If checked, reboots the node if unmounting this file system fails. The default setting is unchecked.
									</para>
								</listitem>
								<listitem>
									<para>
										<guimenu>Check file system before mounting</guimenu> &mdash; If checked, causes <command>fsck</command> to be run on the file system before mounting it. The default setting is unchecked.
									</para>
								</listitem>
							</itemizedlist>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>IP Address</term>
						<listitem>
							<para>
								<guimenu>IP Address</guimenu> &mdash; Type the IP address for the resource.
							</para>
							<para>
								<guimenu>Monitor Link</guimenu> checkbox &mdash; Check the box to enable or disable link status monitoring of the IP address resource
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>NFS Mount</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Create a symbolic name for the NFS mount.
							</para>
							<para>
								<guimenu>Mount Point</guimenu> &mdash; Choose the path to which the file system resource is mounted.
							</para>
							<para>
								<guimenu>Host</guimenu> &mdash; Specify the NFS server name.
							</para>
							<para>
								<guimenu>Export Path</guimenu> &mdash; NFS export on the server.
							</para>
							<para>
								<guimenu>NFS</guimenu> and <guimenu>NFS4</guimenu> options &mdash; Specify NFS protocol:
							</para>
							<itemizedlist>
								<listitem>
									<para>
										<guimenu>NFS</guimenu> &mdash; Specifies using NFSv3 protocol. The default setting is <guimenu>NFS</guimenu>.
									</para>
								</listitem>
								<listitem>
									<para>
										<guimenu>NFS4</guimenu> &mdash; Specifies using NFSv4 protocol.
									</para>
								</listitem>
							</itemizedlist>
							<para>
								<guimenu>Options</guimenu> &mdash; Mount options. For more information, refer to the <citerefentry><refentrytitle>nfs</refentrytitle><manvolnum>5</manvolnum></citerefentry> man page.
							</para>
							<para>
								<guimenu>Force Unmount</guimenu> checkbox &mdash; If checked, forces the file system to unmount. The default setting is unchecked. <guimenu>Force Unmount</guimenu> kills all processes using the mount point to free up the mount when it tries to unmount.
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>NFS Client</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Enter a name for the NFS client resource.
							</para>
							<para>
								<guimenu>Target</guimenu> &mdash; Enter a target for the NFS client resource. Supported targets are hostnames, IP addresses (with wild-card support), and netgroups.
							</para>
							<para>
								<guimenu>Read-Write</guimenu> and <guimenu>Read Only</guimenu> options &mdash; Specify the type of access rights for this NFS client resource:
							</para>
							<itemizedlist>
								<listitem>
									<para>
										<guimenu>Read-Write</guimenu> &mdash; Specifies that the NFS client has read-write access. The default setting is <guimenu>Read-Write</guimenu>.
									</para>
								</listitem>
								<listitem>
									<para>
										<guimenu>Read Only</guimenu> &mdash; Specifies that the NFS client has read-only access.
									</para>
								</listitem>
							</itemizedlist>
							<para>
								<guimenu>Options</guimenu> &mdash; Additional client access rights. For more information, refer to the <citerefentry><refentrytitle>exports</refentrytitle><manvolnum>5</manvolnum></citerefentry> man page, <citerefentry><refentrytitle>General Options</refentrytitle></citerefentry>
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>NFS Export</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Enter a name for the NFS export resource.
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>Script</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Enter a name for the custom user script.
							</para>
							<para>
								<guimenu>File (with path)</guimenu> &mdash; Enter the path where this custom script is located (for example, <filename>/etc/init.d/<replaceable>userscript</replaceable></filename>)
							</para>
						</listitem>
					</varlistentry>
					<varlistentry>
						<term>Samba Service</term>
						<listitem>
							<para>
								<guimenu>Name</guimenu> &mdash; Enter a name for the Samba server.
							</para>
							<para>
								<guimenu>Workgroup</guimenu> &mdash; Enter the Windows workgroup name or Windows NT domain of the Samba service.
							</para>
							<note>
								<title>Note</title>
								<para>
									When creating or editing a cluster service, connect a Samba-service resource directly to the service, <emphasis>not</emphasis> to a resource within a service. That is, at the <guilabel>Service Management</guilabel> dialog box, use either <guibutton>Create a new resource for this service</guibutton> or <guibutton>Add a Shared Resource to this service</guibutton>; do <emphasis>not</emphasis> use <guibutton>Attach a new Private Resource to the Selection</guibutton> or <guibutton>Attach a Shared Resource to the selection</guibutton>.
								</para>
							</note>
						</listitem>
					</varlistentry>
				</variablelist>
			</listitem>
			<listitem>
				<para>
					When finished, click <guibutton>OK</guibutton>.
				</para>
			</listitem>
			<listitem>
				<para>
					Choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the change to the <filename>/etc/cluster/cluster.conf</filename> configuration file.
				</para>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_a_Cluster_Service_to_the_Cluster">
		<title>Adding a Cluster Service to the Cluster</title>
		<indexterm>
			<primary>cluster service managers</primary>
			<secondary>configuration</secondary>
		</indexterm>
		<indexterm>
			<primary>cluster services</primary>
			<seealso>adding to the cluster configuration</seealso>
		</indexterm>
		<para>
			To add a cluster service to the cluster, follow these steps:
		</para>
		<orderedlist>
			<listitem>
				<para>
					At the left frame, click <guimenu>Services</guimenu>.
				</para>
			</listitem>
			<listitem>
				<para>
					At the bottom of the right frame (labeled <guimenu>Properties</guimenu>), click the <guibutton>Create a Service</guibutton> button. Clicking <guibutton>Create a Service</guibutton> causes the <guilabel>Add a Service</guilabel> dialog box to be displayed.
				</para>
			</listitem>
			<listitem>
				<para>
					At the <guilabel>Add a Service</guilabel> dialog box, type the name of the service in the <guimenu>Name</guimenu> text box and click <guibutton>OK</guibutton>. Clicking <guibutton>OK</guibutton> causes the <guilabel>Service Management</guilabel> dialog box to be displayed (refer to <xref linkend="Cluster_Administration-Adding_a_Cluster_Service_to_the_Cluster-Adding_a_Cluster_Service" />).
				</para>
				<tip>
					<title>Tip</title>
					<para>
						Use a descriptive name that clearly distinguishes the service from other services in the cluster.
					</para>
				</tip>
				<figure id="Cluster_Administration-Adding_a_Cluster_Service_to_the_Cluster-Adding_a_Cluster_Service">
					<title>Adding a Cluster Service</title>
					<mediaobject>
						<imageobject>
							<imagedata fileref="./images/service-management-dbox.png" />
						</imageobject>
						<textobject>
							<para>
								Add Cluster Service dialog box
							</para>
						</textobject>
					</mediaobject>
				</figure>
				<para>
				</para>
			</listitem>
			<listitem>
				<para>
					If you want to restrict the members on which this cluster service is able to run, choose a failover domain from the <guimenu>Failover Domain</guimenu> drop-down box. (Refer to <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Configuring_a_Failover_Domain" /> for instructions on how to configure a failover domain.)
				</para>
			</listitem>
			<listitem>
				<para>
					<guimenu>Autostart This Service</guimenu> checkbox &mdash; This is checked by default. If <guimenu>Autostart This Service</guimenu> is checked, the service is started automatically when a cluster is started and running. If <guimenu>Autostart This Service</guimenu> is <emphasis>not</emphasis> checked, the service must be started manually any time the cluster comes up from stopped state.
				</para>
			</listitem>
			<listitem>
				<para>
					<guimenu>Run Exclusive</guimenu> checkbox &mdash; This sets a policy wherein the service only runs on nodes that have <emphasis>no other</emphasis> services running on them. For example, for a very busy web server that is clustered for high availability, it would would be advisable to keep that service on a node alone with no other services competing for his resources &mdash; that is, <guimenu>Run Exclusive</guimenu> checked. On the other hand, services that consume few resources (like NFS and Samba), can run together on the same node without little concern over contention for resources. For those types of services you can leave the <guimenu>Run Exclusive</guimenu> unchecked.
				</para>
				<note>
					<title>Note</title>
					<para>
						Circumstances that require enabling <guimenu>Run Exclusive</guimenu> are rare. Enabling <guimenu>Run Exclusive</guimenu> can render a service offline if the node it is running on fails and no other nodes are empty.
					</para>
				</note>
			</listitem>
			<listitem>
				<para>
					Select a recovery policy to specify how the resource manager should recover from a service failure. At the upper right of the <guilabel>Service Management</guilabel> dialog box, there are three <guimenu>Recovery Policy</guimenu> options available:
				</para>
				<itemizedlist>
					<listitem>
						<para>
							<guimenu>Restart</guimenu> &mdash; Restart the service in the node the service is currently located. The default setting is <guimenu>Restart</guimenu>. If the service cannot be restarted in the the current node, the service is relocated.
						</para>
					</listitem>
					<listitem>
						<para>
							<guimenu>Relocate</guimenu> &mdash; Relocate the service before restarting. Do not restart the node where the service is currently located.
						</para>
					</listitem>
					<listitem>
						<para>
							<guimenu>Disable</guimenu> &mdash; Do not restart the service at all.
						</para>
					</listitem>
				</itemizedlist>
			</listitem>
			<listitem>
				<para>
					Click the <guibutton>Add a Shared Resource to this service</guibutton> button and choose the a resource listed that you have configured in <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_Cluster_Resources" />.
				</para>
				<note>
					<title>Note</title>
					<para>
						If you are adding a Samba-service resource, connect a Samba-service resource directly to the service, <emphasis>not</emphasis> to a resource within a service. That is, at the <guilabel>Service Management</guilabel> dialog box, use either <guibutton>Create a new resource for this service</guibutton> or <guibutton>Add a Shared Resource to this service</guibutton>; do <emphasis>not</emphasis> use <guibutton>Attach a new Private Resource to the Selection</guibutton> or <guibutton>Attach a Shared Resource to the selection</guibutton>.
					</para>
				</note>
			</listitem>
			<listitem>
				<para>
					If needed, you may also create a <firstterm>private</firstterm> resource that you can create that becomes a subordinate resource by clicking on the <guibutton>Attach a new Private Resource to the Selection</guibutton> button. The process is the same as creating a shared resource described in <xref linkend="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Adding_Cluster_Resources" />. The private resource will appear as a child to the shared resource to which you associated with the shared resource. Click the triangle icon next to the shared resource to display any private resources associated.
				</para>
			</listitem>
			<listitem>
				<para>
					When finished, click <guibutton>OK</guibutton>.
				</para>
			</listitem>
			<listitem>
				<para>
					Choose <guimenu>File</guimenu> =&gt; <guimenuitem>Save</guimenuitem> to save the changes to the cluster configuration.
				</para>
			</listitem>
		</orderedlist>
		<note>
			<title>Note</title>
			<para>
				To verify the existence of the IP service resource used in a cluster service, you must use the <command>/sbin/ip addr list</command> command on a cluster node. The following output shows the <command>/sbin/ip addr list</command> command executed on a node running a cluster service:
			</para>
<screen>
1: lo: &lt;LOOPBACK,UP&gt; mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP&gt; mtu 1356 qdisc pfifo_fast qlen 1000
    link/ether 00:05:5d:9a:d8:91 brd ff:ff:ff:ff:ff:ff
    inet 10.11.4.31/22 brd 10.11.7.255 scope global eth0
    inet6 fe80::205:5dff:fe9a:d891/64 scope link
    inet 10.11.4.240/22 scope global secondary eth0
       valid_lft forever preferred_lft forever
</screen>
		</note>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Propagating_The_Configuration_File_New_Cluster">
		<title>Propagating The Configuration File: New Cluster</title>
		<indexterm>
			<primary>cluster service managers</primary>
			<secondary>configuration</secondary>
		</indexterm>
		<indexterm>
			<primary>configuration file</primary>
			<secondary>propagation of</secondary>
		</indexterm>
		<para>
			For newly defined clusters, you must propagate the configuration file to the cluster nodes as follows:
		</para>
		<orderedlist>
			<listitem>
				<para>
					Log in to the node where you created the configuration file.
				</para>
			</listitem>
			<listitem>
				<para>
					Using the <command>scp</command> command, copy the <filename>/etc/cluster/cluster.conf</filename> file to all nodes in the cluster.
				</para>
				<note>
					<title>Note</title>
					<para>
						Propagating the cluster configuration file this way is necessary for the first time a cluster is created. Once a cluster is installed and running, the cluster configuration file is propagated using the &RH; cluster management GUI <guibutton>Send to Cluster</guibutton> button. For more information about propagating the cluster configuration using the GUI <guibutton>Send to Cluster</guibutton> button, refer to <xref linkend="Cluster_Administration-Managing_RH_Cluster_With_system_config_cluster-Modifying_the_Cluster_Configuration" />.
					</para>
				</note>
			</listitem>
		</orderedlist>
	</section>
	
	<section id="Cluster_Administration-Configuring_RH_Cluster_With_system_config_cluster-Starting_the_Cluster_Software">
		<title>Starting the Cluster Software</title>
		<indexterm>
			<primary>starting the cluster software</primary>
		</indexterm>
		<indexterm>
			<primary>cluster</primary>
			<secondary>starting</secondary>
		</indexterm>
		<para>
			After you have propagated the cluster configuration to the cluster nodes you can either reboot each node or start the cluster software on each cluster node by running the following commands at each node in this order:
		</para>
		<orderedlist>
			<listitem>
				<para>
					<command>service cman start</command>
				</para>
			</listitem>
			<listitem>
				<para>
					<command>service clvmd start</command>
				</para>
			</listitem>
			<listitem>
				<para>
					<command>service gfs start</command>, if you are using &RHGFS;
				</para>
			</listitem>
			<listitem>
				<para>
					<command>service rgmanager start</command>
				</para>
			</listitem>
			<listitem>
				<para>
					Start the &RHCS; management GUI. At the <application>&RHCLUSTERTOOL;</application> tab, verify that the configuration is correct. At the <application>&RHCLUSTERSTATTOOL;</application> tab verify that the nodes and services are running as expected.
				</para>
			</listitem>
		</orderedlist>
	</section>

</chapter>

